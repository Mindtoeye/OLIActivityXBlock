/*! oliapi 2017-06-19 */
function formatLogMessageGoogle(a,b,c){return"["+a+":"+b+"] "+new SimonBase(a,b).htmlEncode(c)}function simondebug(a){if(useDebugging||useDebuggingBasic){if(null===a)return void(a="Empty message!");simondebug.debugPointer||(simondebug.debugPointer=new SimonBase("Simon","class")),simondebug.debugPointer.simondebug(a,"SimonClass")}}function generateSalt(){var a=new Uint8Array(20);return window.crypto.getRandomValues(a)}function encryptUserId(a){var b=a,c=a.toLowerCase(),d=STU_PREFIX;if(c.startsWith(WEIRDCMU_PREFIX)&&(d=TEST_PREFIX),c.startsWith(FIRE_PREFIX)&&c.length()==FIRE_LEN)b=a;else{var e=generateSalt().toString();b=d+CryptoJS.MD5(a+e)}return b}function OLIBrowserCheck(){return!(document.documentMode<9)||(document.body.innerHTML="",document.write("The content you are trying to view is not supported in the current Document Mode of Internet Explorer. Change the Document Mode to Internet Explorer 9 Standards and try to view the content again.<br>To change the Document Mode, press F12, click Document Mode: <current mode>, and then select Internet Explorer 9 Standards."),!1)}function OLIFormatLogMessage(a,b,c){null===a&&(a="unknownclass"),null===b&&(b="nullinstance");var d=c,e="["+logIndex+"]["+a+":"+b+"] "+d;return logIndex++,e}function olidebug(a){simondebug(a)}function OLIExternalAdaptiveActivity(a,b,c,d,e){var f=this,g=b,h=encryptUserId(b),i=d,j=c,k="none",l=0,m={pg:.25,ps:.25,pi:.1,pt:.5,threshold:.99},n=["describesample","idsampling","identifybiassample","critique","experimvsobs","surveydesign","lurkingvar","studydesigndefin","idstudydesign"],o=null,p=null;this.setCurrentProblem=function(a){k=a},this.getCurrentProblem=function(){return k},this.incAttemptCount=function(){l++},this.setAttemptCount=function(a){l=a},this.getAttemptCount=function(){return l},this.registerUser=function(a,b){simondebug("registerUser ("+g+" -> "+h+")"),simondebug("Let's pretend for now that we have an anonymous id. This will ensure that for testing purposes we always get a new id"),f.processGetAnonIDSucceeded({result:"success"})},this.configureUser=function(){simondebug("configureUser ()");var a={course_id:j,params:m,user_id:h,skills_list:n};return $.ajax({url:i+"/parameters/bulk",type:"POST",contentType:"application/json",data:JSON.stringify(a)}).done(function(){simondebug("Skills: "+n+" is  configured")}).fail(function(){simondebug('Failed to configure skills: "'+n+'" for user "'+h+'"'),p&&p()})},this.registerUserInEdxAdapt=function(){simondebug("registerUserInEdxAdapt ()"),$.ajax({url:i+"/course/"+j+"/user",type:"POST",contentType:"application/json",data:JSON.stringify({user_id:h})}).done(function(){simondebug("User Created"),o&&o(),f.setStatusOk()}).fail(function(){simondebug("Failed to create user"),f.setStatusNok(),p&&p()})},this.pageLoadComplete=function(){simondebug("pageLoadComplete ("+f.getCurrentProblem()+")");var a=JSON.stringify({problem:f.getCurrentProblem()});console.log("pageLoad: "+a),$.ajax({url:i+"/course/"+j+"/user/"+h+"/pageload",type:"POST",contentType:"application/json",data:a}).done(function(){simondebug("Pageload confirmed")}).fail(function(){simondebug("Unable to confirm pageload")})},this.indicateProblemComplete=function(a,b){simondebug("indicateProblemComplete ("+a+")");var c=JSON.stringify({problem:f.getCurrentProblem(),correct:a,attempt:b});console.log("pageLoad: "+c),$.ajax({url:i+"/course/"+j+"/user/"+h+"/interaction",type:"POST",contentType:"application/json",data:c}).done(function(){simondebug("Pageload confirmed")}).fail(function(){simondebug("Unable to confirm pageload")})},this.processGetAnonIDSucceeded=function(a){simondebug("processGetAnonIDSucceeded ()"),a&&simondebug("Data: "+JSON.stringify(a)),simondebug("Checking if student already registered in EdxAdapt ..."),$.ajax({url:i+"/course/"+j+"/user/"+h,type:"GET",contentType:"application/json"}).done(function(a,b){simondebug("Success, the student already exists in Edx-Adapt: "+a+" : "+b),f.setStatusOk(),o&&o(a)}).fail(function(a,b){404==a.status&&(simondebug("Student not found in EdxAdapt. Let's configure and register them ..."),$.when.apply($,f.configureUser()).then(f.registerUserInEdxAdapt())),simondebug("Failed to register student in EdxAdapt: "+a.responseText)})},this.processGetAnonIDFail=function(a){simondebug("processGetAnonIDFail ()"),APIActivity.setValue("anonymousid",h,f.processGetAnonIDSucceeded),f.processGetAnonIDSucceeded()},this.getFirstAdaptiveProblem=function(a){simondebug("getFirstAdaptiveProblem ()"),$.ajax({url:i+"/course/"+j+"/user/"+h,type:"GET",contentType:"application/json"}).done(function(b,c){simondebug("First problem successfully found",c),a&&a(b)}).fail(function(a,b){simondebug("Failed to get first adaptive problem for student from EdxAdapt",a.responseText)})},this.getNextAdaptiveProblem=function(a){simondebug("getNextAdaptiveProblem ()"),$.ajax({url:i+"/course/"+j+"/user/"+h,type:"GET",contentType:"application/json"}).done(function(b,c){simondebug("First problem successfully found",c),a&&a(b)}).fail(function(a,b){simondebug("Failed to get first adaptive problem for student from EdxAdapt",a.responseText)})},this.setStatusOk=function(){simondebug("setStatusOk ()")},this.setStatusNok=function(){simondebug("setStatusNok ()")}}function OLITutorgenAdaptiveActivity(a,b,c,d,e){var f=b,g=this,h=f,i=f,j=d,k=c,l="oliglobal",m="5",n="none",o=0,p=0,q="",n="",r=[];this.setCurrentProblem=function(a){n=a},this.getCurrentProblem=function(){return n},this.incAttemptCount=function(){o++},this.setAttemptCount=function(a){o=a},this.getAttemptCount=function(){return o},this.getRequest=function(a,b,c){$.ajax({url:a,type:"GET",contentType:"application/json",xhrFields:{withCredentials:!0},beforeSend:function(a){a.setRequestHeader("Authorization","Basic "+q)}}).done(function(a){simondebug("getRequest succeeded"),b&&b(a)}).fail(function(a){simondebug("getRequest failed"),c&&c(a)})},this.postRequest=function(a,b,c,d){simondebug("postRequest ()"),$.ajax({url:a,type:"POST",contentType:"application/json",data:JSON.stringify(b),xhrFields:{withCredentials:!0},beforeSend:function(a){a.setRequestHeader("Authorization","Basic "+q)}}).done(function(a){simondebug("postRequest succeeded"),c&&c(a)}).fail(function(a){simondebug("postRequest failed"),d&&d(a)})},this.prepAuth=function(){simondebug("prepAuth ()");var a=APIActivity.findResourcesByType("auth");if(0==a.length)return void showFeedback("Error, no authentication info found, please check your xml file.");q=btoa(a[0]),olidebug("Auth string set to: "+q)},this.prepTutorGen=function(){simondebug("prepTutorGen ()");var a=APIActivity.findResourcesByType("tutorgen");if(0==a.length)return void showFeedback("Error, no tutorgen info found, please check your xml file.");var b=a.length[0].split(":");m=b[0],k=b[1]},this.createGroup=function(){simondebug("createGroup ()"),g.getRequest(j+m+"/content-groupings/",function(a){simondebug("Group data retrieved, analyzing ...");var b={ls_cg_id:l,name:"Global OLI content group for all embedded activities",course:k},c=!0;if(a.results)for(var d=a.results,e=0;e<d.length;e++){var f=d[e];f.ls_cg_id==l&&(simondebug("Our group Id already exists, indicating we won't have to register again ..."),c=!1)}1==c&&g.postRequest(j+m+"/content-groupings/",b,function(){simondebug("succeeded")},function(){simondebug("failed")})},function(){})},this.createKCs=function(a){simondebug("createKCs ()"),g.getRequest(j+m+"/kcs/",function(){simondebug("succeeded")},function(){simondebug("failed")})},this.createUser=function(){simondebug("createUser ()");var a={ls_learner_id:i,name:"Currently not Sent",courses:k};g.postRequest(j+m+"/learners/",a,function(){simondebug("succeeded")},function(){simondebug("failed")})},this.checkUserExists=function(a){simondebug("checkUserExists ()"),simondebug("request response: "+JSON.stringify(a));var b=!0;if(!a)return simondebug("There is no data to examine, bump"),!1;if(a.ls_learner_id)a.ls_learner_id!=i&&(b=!1);else{if(!a.responseJSON)return simondebug("data [detail] not found in message, bump"),!1;if(!a.responseJSON.detail)return simondebug("data [responseJSON] doesn't have expected value, bump"),!1;if(simondebug("Explicit message that the user was not found, marking for creation ..."),"Not found."!=a.responseJSON.detail)return simondebug("data [responseJSON][detail] doesn't have expected value, bump"),!1;b=!1}return 0==b&&(simondebug("User does not exist, creating ..."),g.createUser()),!0},this.registerUser=function(a,b){simondebug("registerUser ("+h+" -> "+i+")"),g.prepAuth(),g.createGroup(),g.loadProblemsFromTutorgen(),g.getRequest(j+m+"/learners/"+i+"/",function(c){1==g.checkUserExists(c)?a&&a():b&&b()},function(c){1==g.checkUserExists(c)?a&&a():b&&b()})},this.parseProblems=function(a){simondebug("parseProblems ()"),r=[];for(var b=a.split("\r\n"),c=0;c<b.length;c++){var d=b[c].split(",");r.push({problem:d[0],skills:d[1]})}},this.loadProblemsFromTutorgen=function(){simondebug("loadProblemsFromTutorgen ()");var a=APIActivity.findResourcesByType("problems");if(0==a.length)return void showFeedback("Error, no problem definitions found, please check your xml file.");olidebug("Loading "+a.length+" problem file(s) ..."),p=0;for(var b=0;b<a.length;b++){var c=APIActivity.getDownloadableResource(a[b]);g.getRequest(c,function(b){olidebug("success loading problem set "+p),g.parseProblems(b),++p>a.length-1&&(olidebug("All problem definitions loaded from OLI, processing ..."),g.getRequest(j+m+"/problems/",function(a){if(a.count>0)return void simondebug("The server gave us some problems in the list, we're going to assume we've already uploaded what we have");g.createKCs(a),g.problemsLoaded(a)},function(){}))},function(){})}},this.problemsLoaded=function(a){simondebug("problemsLoaded ()");for(var b=0;b<r.length;b++){console.log("Creating problem on the server: "+JSON.stringify(r[b]));var c=r[b],d={ls_problem_id:c.problem,cg1:"oliglobal",kcs:[c.skills]};g.postRequest(j+m+"/problems/",d,function(){},function(){})}},this.pageLoadComplete=function(){simondebug("pageLoadComplete ()")},this.indicateProblemComplete=function(a,b){simondebug("indicateProblemComplete ("+a+")");var c=0,d="incorrect";1==a&&(c=1,d="correct");var e={learner:i,problem:n,result:a,answer:d,score:c,num_attempts:b};g.postRequest(j+m+"/transactions/",e,function(){},function(){})},this.getFirstAdaptiveProblem=function(a){simondebug("getFirstAdaptiveProblem ()"),n=r[0].problem,a({next:{problem_name:n},done_with_course:!1})},this.getNextAdaptiveProblem=function(a){simondebug("getNextAdaptiveProblem ()"),g.getRequest(j+m+"/activities/"+i+"/",function(b){if(a){n=b.next_activity;var c=b.level_up;a({next:{problem_name:n},done_with_course:c})}},function(){})},this.setStatusOk=function(){simondebug("setStatusOk ()")},this.setStatusNok=function(){simondebug("setStatusNok ()")},simondebug("OLITutorgenAdaptiveActivity ()")}function logActivityStart(a){console.log("logActivityStart ()");var b=new ActionLog(CommonLogActionNames.START_STEP,APIActivity.getSuperClient().sessionId,APIActivity.getSuperClient().resourceId,APIActivity.getSuperClient().activityGuid,"CTAT_SESSIONSTART",APIActivity.getSuperClient().timeZone),c=new SupplementLog;c.setAction(CommonLogActionNames.START_STEP_TRACK),c.setSource(a),c.setInfoType("CTAT_SESSIONSTART"),b.addSupplement(c),APIActivity.getSuperClient().logAction(b)}function logCorrect(a,b){console.log("logCorrect ()");var c=new ActionLog(CommonLogActionNames.EVALUATE_QUESTION,APIActivity.getSuperClient().sessionId,APIActivity.getSuperClient().resourceId,APIActivity.getSuperClient().activityGuid,"CTAT_TUTORCORRECT",APIActivity.getSuperClient().timeZone),d=new SupplementLog;d.setAction(CommonLogActionNames.EVALUATE_QUESTION),d.setSource(a.getSelection()),d.setInfoType("CTATTutor"),c.addSupplement(d),APIActivity.getSuperClient().logAction(c)}function logIncorrect(a,b){console.log("logIncorrect ()");var c=new ActionLog(CommonLogActionNames.EVALUATE_QUESTION,APIActivity.getSuperClient().sessionId,APIActivity.getSuperClient().resourceId,APIActivity.getSuperClient().activityGuid,"CTAT_TUTORINCORRECT",APIActivity.getSuperClient().timeZone),d=new SupplementLog;d.setAction(CommonLogActionNames.EVALUATE_QUESTION),d.setSource(a.getSelection()),d.setInfoType("CTATTutor"),c.addSupplement(d),APIActivity.getSuperClient().logAction(c)}function processCommShellEvent(a,b){if(console.log("processCommShellEvent ()"),"AssociatedRules"==a&&b){var c=b.getIndicator(),d=b.getSAI(),e=d?d.getSelection():"_noSuchComponent_",f=CTATShellTools.findComponent(e),g=f&&f.length?f[0]:null;console.log("Indicator: "+c),"hint"==c.toLowerCase()&&console.log("Logging hint for sai: "+d.toString()),g&&"incorrect"==c.toLowerCase()&&(console.log("Tutor's answer is "+d.toString()),logIncorrect(d,b)),g&&"correct"==c.toLowerCase()&&(console.log("Tutor's answer is "+d.toString()),logCorrect(d,b))}}function enableCTATDashboardFunctionality(a){console.log("enableCTATDashboardFunctionality ()");var b={processCommShellEvent:function(a,b){if(console.log("processCommShellEvent ()"),"AssociatedRules"==a&&b){var c=b.getIndicator(),d=b.getSAI(),e=d?d.getSelection():"_noSuchComponent_",f=CTATShellTools.findComponent(e),g=f&&f.length?f[0]:null;console.log("Indicator: "+c),g&&"incorrect"==c.toLowerCase()&&(console.log("Tutor's answer is "+d.toString()),logIncorrect(d,b)),g&&"correct"==c.toLowerCase()&&(console.log("Tutor's answer is "+d.toString()),logCorrect(d,b))}}};CTATCommShell.commShell.addGlobalEventListener(b),logActivityStart(a)}function logOLIActivityStart(a,b){console.log("logOLIActivityStart ()");var c=new ActionLog(CommonLogActionNames.START_STEP,APIActivity.getSuperClient().sessionId,APIActivity.getSuperClient().resourceId,APIActivity.getSuperClient().activityGuid,"OLI_SESSIONSTART",APIActivity.getSuperClient().timeZone),d=new SupplementLog;d.setAction(CommonLogActionNames.START_STEP_TRACK),d.setSource(b),d.setInfoType(a),c.addSupplement(d),APIActivity.getSuperClient().logAction(c)}function logOLICorrect(a,b,c){console.log("logOLICorrect ()");var d=new ActionLog(CommonLogActionNames.EVALUATE_QUESTION,APIActivity.getSuperClient().sessionId,APIActivity.getSuperClient().resourceId,APIActivity.getSuperClient().activityGuid,"OLI_ACTIVITYCORRECT",APIActivity.getSuperClient().timeZone),e=new SupplementLog;e.setAction(CommonLogActionNames.EVALUATE_QUESTION),e.setSource(b.getSelection()),e.setInfoType(a),d.addSupplement(e),APIActivity.getSuperClient().logAction(d)}function logOLIIncorrect(a,b,c){console.log("logOLIIncorrect ()");var d=new ActionLog(CommonLogActionNames.EVALUATE_QUESTION,APIActivity.getSuperClient().sessionId,APIActivity.getSuperClient().resourceId,APIActivity.getSuperClient().activityGuid,"OLI_ACTIVITYINCORRECT",APIActivity.getSuperClient().timeZone),e=new SupplementLog;e.setAction(CommonLogActionNames.EVALUATE_QUESTION),e.setSource(b.getSelection()),e.setInfoType(a),d.addSupplement(e),APIActivity.getSuperClient().logAction(d)}function logOLIHint(a,b,c){console.log("logOLIHint ()");var d=new ActionLog(CommonLogActionNames.VIEW_HINT,APIActivity.getSuperClient().sessionId,APIActivity.getSuperClient().resourceId,APIActivity.getSuperClient().activityGuid,"OLI_EMBEDDEDACTIVITY",APIActivity.getSuperClient().timeZone),e=new SupplementLog;e.setAction(CommonLogActionNames.VIEW_HINT),e.setSource(sai.getSelection()),e.setInfoType(c),e.setInfo("<![CDATA["+a+"]]>"),d.addSupplement(e),e=new SupplementLog,e.setAction(CommonLogActionNames.VIEW_HINT_TRACK),e.setSource(b),e.setInfoType(c),e.setInfo("<![CDATA["+a+"]]>"),d.addSupplement(e),APIActivity.getSuperClient().logAction(d)}SimonBase=function(a,b){function c(a,b,c){return null===a&&(a="unknownclass"),null===b&&(b="nullinstance"),"["+a+":"+b+"] "+c}var d=a,e=b,f=this;this.getClassName=function(){return d},this.getClassname=function(){return d},this.setClassName=function(a){d=a},this.setName=function(a){e=a},this.getName=function(){return e},this.getUseDebugging=function(){return useDebugging},this.setUseDebugging=function(a){useDebugging=a},this.toHHMMSS=function(a){var b=parseInt(a,10),c=Math.floor(b/3600),d=Math.floor((b-3600*c)/60),e=b-3600*c-60*d;return c<10&&(c="0"+c),d<10&&(d="0"+d),e<10&&(e="0"+e),c+":"+d+":"+e},this.simondebug=function(a){if(useDebugging){var b=a;if(useDebuggingBasic)return void f.simondebugInternal(b,"UnknownClass");null===a&&(b="No message provided"),f.simondebugInternal(b,f.getClassName())}},this.simondebugObject=function(a){var b=0;for(var c in a)f.simondebug("("+b+")"+c+": "+a[c]),b++},this.simondebugInternal=function(a,b){var d=a,e="No msg assigned yet";if(null!==d&&void 0!==d||(d="No message!"),""===d&&(d="Empty message!"),useDebuggingBasic)return e=c("Unknown","undefined",d),SimonBase.customconsole||(SimonBase.customconsole=getSafeElementById("customconsole")),void(SimonBase.customconsole&&(SimonBase.customconsole.innerHTML+=e+"<br>",SimonBase.customconsole.scrollTop=SimonBase.customconsole.scrollHeight));null===b&&(b="UndefinedClass"),null===d&&(d="No message"),e=c(b,f.getName(),d),console.log(e)},this.simondebugObjectShallow=function(a){var b="";for(var c in a)b+=c+", ";f.simondebugInternal("Object: "+b,"Global")},this.urldecode=function(a){return decodeURIComponent((a+"").replace(/\+/g,"%20"))},this.entitiesConvert=function(a){return this.simondebug("entitiesConvert ()"),this.urldecode(unescape(a))},this.entitiesGenerate=function(a){return a}},Object.defineProperty(SimonBase,"DebuggingFilter",{enumerable:!1,configurable:!1,writable:!0,value:[]}),"undefined"!=typeof module&&(module.exports=SimonBase);var useDebugging;void 0===useDebugging&&(useDebugging=!1);var useDebuggingBasic;void 0===useDebuggingBasic&&(useDebuggingBasic=!1);var WEIRDCMU_PREFIX="weirdcmu",FIRE_PREFIX="fire_",FIRE_LEN=37,STU_PREFIX="Stu_",TEST_PREFIX="Test_",FallbackMD5=function(a){function b(a,b){return a<<b|a>>>32-b}function c(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return a&c|b&~c}function f(a,b,c){return a^b^c}function g(a,b,c){return b^(a|~c)}function h(a,e,f,g,h,i,j){return a=c(a,c(c(d(e,f,g),h),j)),c(b(a,i),e)}function i(a,d,f,g,h,i,j){return a=c(a,c(c(e(d,f,g),h),j)),c(b(a,i),d)}function j(a,d,e,g,h,i,j){return a=c(a,c(c(f(d,e,g),h),j)),c(b(a,i),d)}function k(a,d,e,f,h,i,j){return a=c(a,c(c(g(d,e,f),h),j)),c(b(a,i),d)}function l(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=Array(f-1),h=0,i=0;i<c;)b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g}function m(a){var b,c,d="",e="";for(c=0;c<=3;c++)b=a>>>8*c&255,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d}function n(a){a=a.replace(/rn/g,"n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b}var o,p,q,r,s,t,u,v,w,x=Array(),y=7,z=12,A=17,B=22,C=5,D=9,E=14,F=20,G=4,H=11,I=16,J=23,K=6,L=10,M=15,N=21;for(a=n(a),x=l(a),t=1732584193,u=4023233417,v=2562383102,w=271733878,o=0;o<x.length;o+=16)p=t,q=u,r=v,s=w,t=h(t,u,v,w,x[o+0],y,3614090360),w=h(w,t,u,v,x[o+1],z,3905402710),v=h(v,w,t,u,x[o+2],A,606105819),u=h(u,v,w,t,x[o+3],B,3250441966),t=h(t,u,v,w,x[o+4],y,4118548399),w=h(w,t,u,v,x[o+5],z,1200080426),v=h(v,w,t,u,x[o+6],A,2821735955),u=h(u,v,w,t,x[o+7],B,4249261313),t=h(t,u,v,w,x[o+8],y,1770035416),w=h(w,t,u,v,x[o+9],z,2336552879),v=h(v,w,t,u,x[o+10],A,4294925233),u=h(u,v,w,t,x[o+11],B,2304563134),t=h(t,u,v,w,x[o+12],y,1804603682),w=h(w,t,u,v,x[o+13],z,4254626195),v=h(v,w,t,u,x[o+14],A,2792965006),u=h(u,v,w,t,x[o+15],B,1236535329),t=i(t,u,v,w,x[o+1],C,4129170786),w=i(w,t,u,v,x[o+6],D,3225465664),v=i(v,w,t,u,x[o+11],E,643717713),u=i(u,v,w,t,x[o+0],F,3921069994),t=i(t,u,v,w,x[o+5],C,3593408605),w=i(w,t,u,v,x[o+10],D,38016083),v=i(v,w,t,u,x[o+15],E,3634488961),u=i(u,v,w,t,x[o+4],F,3889429448),t=i(t,u,v,w,x[o+9],C,568446438),w=i(w,t,u,v,x[o+14],D,3275163606),v=i(v,w,t,u,x[o+3],E,4107603335),u=i(u,v,w,t,x[o+8],F,1163531501),t=i(t,u,v,w,x[o+13],C,2850285829),w=i(w,t,u,v,x[o+2],D,4243563512),v=i(v,w,t,u,x[o+7],E,1735328473),u=i(u,v,w,t,x[o+12],F,2368359562),t=j(t,u,v,w,x[o+5],G,4294588738),w=j(w,t,u,v,x[o+8],H,2272392833),v=j(v,w,t,u,x[o+11],I,1839030562),u=j(u,v,w,t,x[o+14],J,4259657740),t=j(t,u,v,w,x[o+1],G,2763975236),w=j(w,t,u,v,x[o+4],H,1272893353),v=j(v,w,t,u,x[o+7],I,4139469664),u=j(u,v,w,t,x[o+10],J,3200236656),t=j(t,u,v,w,x[o+13],G,681279174),w=j(w,t,u,v,x[o+0],H,3936430074),v=j(v,w,t,u,x[o+3],I,3572445317),u=j(u,v,w,t,x[o+6],J,76029189),t=j(t,u,v,w,x[o+9],G,3654602809),w=j(w,t,u,v,x[o+12],H,3873151461),v=j(v,w,t,u,x[o+15],I,530742520),u=j(u,v,w,t,x[o+2],J,3299628645),t=k(t,u,v,w,x[o+0],K,4096336452),w=k(w,t,u,v,x[o+7],L,1126891415),v=k(v,w,t,u,x[o+14],M,2878612391),u=k(u,v,w,t,x[o+5],N,4237533241),t=k(t,u,v,w,x[o+12],K,1700485571),w=k(w,t,u,v,x[o+3],L,2399980690),v=k(v,w,t,u,x[o+10],M,4293915773),u=k(u,v,w,t,x[o+1],N,2240044497),t=k(t,u,v,w,x[o+8],K,1873313359),w=k(w,t,u,v,x[o+15],L,4264355552),v=k(v,w,t,u,x[o+6],M,2734768916),u=k(u,v,w,t,x[o+13],N,1309151649),t=k(t,u,v,w,x[o+4],K,4149444226),w=k(w,t,u,v,x[o+11],L,3174756917),v=k(v,w,t,u,x[o+2],M,718787259),u=k(u,v,w,t,x[o+9],N,3951481745),t=c(t,p),u=c(u,q),v=c(v,r),w=c(w,s);return(m(t)+m(u)+m(v)+m(w)).toLowerCase()},logIndex=1,loadIndex=0,buildCalled=!1,isAngular=!1,transformedTable={},monitorURL="",__origDefine=define,activityBasepath="",APIActivity=null,fullscreenEnterIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACAAgMAAAC+UIlYAAAACVBMVEUAAAAAAAAAAACDY+nAAAAAAnRSTlMAgJsrThgAAADHSURBVFjD7daxEcMgDEBR1GgITeN5mEZDqBFTpkjs4Avw+xiV3Cv+qeBUyp493TSY54D1lp4M6rmkGTACSkAInBFzYASUgBD4RCyAEVACQuAdsQJGQAkIgVIJGAElIARKJWAElIAQKJWAEVACQqBUAkZACcgFDvpAnEAQSALtIOAEgkASmEZcwAkEgSQwi/gCJxAEksAkogNOIAgkgXFED5xAEEgCw4gbcAJBIAmMIu7ACQSB3GfSEuy7uv1safD0MAAL+nfwAj9TPO6QpGE4AAAAAElFTkSuQmCC",fullscreenEndIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACAAgMAAAC+UIlYAAAACVBMVEUAAAAAAAAAAACDY+nAAAAAAnRSTlMAgJsrThgAAADHSURBVFjD7daxEcMgDEBR1GgITeN5mEZDqBFTpkjs4Avw+xiV3Cv+qeBUyp493TSY54D1lp4M6rmkGTACSkAInBFzYASUgBD4RCyAEVACQuAdsQJGQAkIgVIJGAElIARKJWAElIAQKJWAEVACQqBUAkZACcgFDvpAnEAQSALtIOAEgkASmEZcwAkEgSQwi/gCJxAEksAkogNOIAgkgXFED5xAEEgCw4gbcAJBIAmMIu7ACQSB3GfSEuy7uv1safD0MAAL+nfwAj9TPO6QpGE4AAAAAElFTkSuQmCC";if(!define)var dummyKickoff=null,define=function(a){dummyKickoff=a,$(function(){dummyKickoff(),APIActivity.init(superClient,getLaunchAttributes(!1))})};define(function(){function a(){useDebugging=!0,olidebug("OLIAPI ()");var a=null,b=null,c=null,d=[],e="Unassigned",f=(new SaveData,[]),g=null,h=this;this.init=function(f,g){olidebug("init ()"),a=f,b=g,c=$(b).find("title").text();var i=0;$(b).find("title")&&(e=$(b).find("title").text()),$(b).find("assets").children("asset").each(function(a){olidebug("asset name "+$(this).attr("name")+" value "+$(this).text());var b={type:$(this).attr("name"),source:$(this).text()};d[i]=b,i++}),0==i?(olidebug("No assets found, either we're in a minimal activity or we're not embedded, calling build straight up ..."),h.kickoff()):(h.prepResources(),h.sortResources(),h.loadResources())},this.kickoff=function(){simondebug("kickoff ()"),"undefined"!=typeof startActivity?startActivity():(olidebug("No startActivity function provided, trying the fallback 'build ()' function ..."),"undefined"!=typeof build?build():olidebug("No build function provided, bump"))},this.getQuestionTitle=function(){return e},this.assignAdaptiveDriver=function(a){g=a},this.getAdaptiveDriver=function(){return g},this.getActivityData=function(){return b},this.getSuperClient=function(){return a},this.getNativeLogger=function(){return oliLogger},this.getDatashopLogger=function(){return null},this.getValue=function(b,c,d){var e={fileName:b,attemptNumber:1};a.post("loadFileRecord",e,!0,!0,c,d)},this.deleteValue=function(b,c,d){olidebug("deleteValue()");var e={fileName:b,attemptNumber:1};a.post("deleteFileRecord",e,!0,!0,c,d)},this.setValue=function(b,c,d,e){a.writeFileRecord(b,"text/plain",1,c,d,e)},this.setActivityBasepath=function(a){var b=a;if(!a)return void(activityBasepath="");olidebug("Path last char: "+a[a.length-1]),"/"!=a[a.length-1]&&(b=a+"/"),activityBasepath=b},this.getActivityBasepath=function(){return activityBasepath},this.imgCreate=function(a,b,c){var d=document.createElement("img");return d.src=a,null!=b&&(d.alt=b),null!=c&&(d.title=c),d},this.resolveResources=function(b,c){var d=a.webContentFolder+c;return b.replace(/<ACTIVITYPATH>/g,d)},this.mapResources=function(a,b){olidebug("mapResources ("+a.length+")");for(var c=0;c<a.length;c++){var d=a[c];a[c]=h.getDownloadableResource(d,b)}return a},this.mapResourceTable=function(a,b){olidebug("mapResourceTable ()"),transformedTable={};for(var c in a)if(a.hasOwnProperty(c))if("___"==c)transformedTable.___="___";else{var d=a[c];transformedTable[c]=h.getDownloadableResource(d,b)}return transformedTable},this.findResourceByExtension=function(a){olidebug("findResourceByExtension ()");for(var b=0;b<d.length;b++){var c=d[b];if(-1!=c.source.indexOf(a))return c.source}return null},this.findResourceByType=function(a){olidebug("findResourceByType ()");for(var b=0;b<d.length;b++){var c=d[b];if(c.type==a)return c.source}return null},this.findResourcesByType=function(a){olidebug("findResourcesByType ("+a+")");var b=0;f=[];for(var c=0;c<d.length;c++){var e=d[c];e.type==a&&(olidebug("Found resource, addding: "+e.source),f[b]=e.source,b++)}return f},this.getDownloadableResource=function(b,c){null==c&&(c="");var d=a.webContentFolder+c+b;return-1==b.indexOf("http://")&&-1==b.indexOf("https://")||(d=b),d},this.getSuperActivityObject=function(){return a},this.makeAngularCompatible=function(){olidebug("makeAngularCompatible ()"),isAngular=!0},this.getScript=function(a,b,c){olidebug("getScript ()");var d=h.getDownloadableResource(a,b);__origDefine=define,define=null,$.getScript(d,function(a,b,d){olidebug(b),olidebug(d.status),olidebug("Load was performed."),define=__origDefine,c&&c()}).done(function(a,b){olidebug("Script load done: "+b)}).fail(function(a,b,c){olidebug("Triggered ajaxError handler: "+c)})},this.goFullscreen=function(a){if(olidebug("goFullscreen ()"),a){var b=document.getElementById(a);b&&olidebug("We have a target frame object"),b.webkitRequestFullscreen?0==b.contentDocument.webkitIsFullScreen?b.webkitRequestFullscreen():b.contentDocument.webkitCancelFullScreen():b.fullScreenElement&&null!==b.fullScreenElement||!b.mozFullScreen&&!b.webkitIsFullScreen?b.requestFullScreen?b.requestFullScreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullScreen&&b.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):b.cancelFullScreen?targetDocument.cancelFullScreen():targetDocument.mozCancelFullScreen?targetDocument.mozCancelFullScreen():targetDocument.webkitCancelFullScreen&&targetDocument.webkitCancelFullScreen()}else document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},this.resizeIframe=function(){olidebug("resizeIframe ()"),olidebug("body height "+$("body").prop("scrollHeight"))},this.moveResource=function(a,b){d.splice(b,0,d.splice(a,1)[0])},this.patchCaptivate=function(a){olidebug("patchCaptivate ()"),cp.model.projectImages=h.mapResources(cp.model.projectImages,a),cp.model.images=h.mapResources(cp.model.images,a),cp.model.videos=h.mapResources(cp.model.videos,a),cp.model.slideVideos=h.mapResources(cp.model.slideVideos,a),cp.model.tocVideos=h.mapResources(cp.model.tocVideos,a),cp.model.audios=h.mapResources(cp.model.audios,a);for(var b in cp.model.data)if(cp.model.data.hasOwnProperty(b)){var c=cp.model.data[b];for(var d in c)c.hasOwnProperty(d)&&("src"!=d&&"ip"!=d||-1!=c[d].indexOf("ar/")&&(c[d]=h.getDownloadableResource(c[d],a)))}olidebug("patchCaptivate () done")},this.prepResources=function(){olidebug("prepResources ()");for(var a=0;a<d.length;a++){var b=d[a];"basepath"!=b.type&&"base"!=b.type||(olidebug("Setting base path to: "+b.source),activityBasepath=b.source+"/",processed=!1)}},this.sortResources=function(){olidebug("sortResources ()");for(var a=!1;0==a;){a=!0;for(var b=0;b<d.length;b++){var c=d[b];if("layout"==c.type&&0!=b){olidebug("Moving html resource ("+c.source+") to the top of the list ..."),h.moveResource(b,0);break}}}},this.loadResources=function(){if(olidebug("loadResources ()"),$.holdReady(!0),document.getElementsByTagName("head")[0].addEventListener("load",h.processResourceLoad,!0),0==loadIndex)return void h.loadNextResource()},this.processResourceLoad=function(a){if(1==buildCalled)return void olidebug("Activity already bootstrapped, bump");if(loadIndex>d.length)return void olidebug("Everything from the oli activity already loaded, this event must be from custom code");if(null==a.target.nodeName||null==a.target.getAttribute("id"))return void olidebug("Null resource loaded or non OLI API generated => "+a.target.nodeValue);if("SCRIPT"===a.target.nodeName||"script"===a.target.nodeName){var b=a.target.getAttribute("src");return olidebug("Script loaded: "+b),void h.loadNextResource()}if("LINK"===a.target.nodeName||"link"===a.target.nodeName||"STYLE"===a.target.nodeName||"style"===a.target.nodeName){var b=a.target.getAttribute("href");return olidebug("CSS loaded: "+b),void h.loadNextResource()}},this.scheduleLoading=function(a,b){olidebug("scheduleLoading ()"),monitorURL=b,document.head.appendChild(a)},this.bootstrap=function(){if(olidebug("bootstrap ()"),1==buildCalled)return void olidebug("We're already bootstrapped, bump");olidebug("All resources loaded, bootstrapping ..."),$.holdReady(!1),0==buildCalled?(buildCalled=!0,h.kickoff()):olidebug("The user defined 'build' has already been called!")},this.loadNextResource=function(){if(olidebug("loadNextResource ()"),loadIndex>=d.length)return olidebug("All resources loaded, starting activity bootstrap ..."),void h.bootstrap();var a=d[loadIndex];loadIndex++;var b=h.getDownloadableResource(a.source);olidebug("Processing resource: "+b);var c=!1;if("style"==a.type){var e=document.createElement("link");e.id="id"+loadIndex,e.rel="stylesheet",e.href=b,h.scheduleLoading(e,b),c=!0}if("javascript"==a.type){-1!=b.indexOf("angular")&&h.makeAngularCompatible();var f=document.createElement("script");f.id="id"+loadIndex,f.type="text/javascript",f.src=b,h.scheduleLoading(f,b),c=!0}"layout"==a.type&&$.get(b,function(a){var b=h.resolveResources(a,activityBasepath);$("#oli-embed").append(b),$(".type1").hide()}),0==c&&(olidebug("Unknown resource type found or html, loading next ..."),h.loadNextResource())}}return APIActivity=new a}),olidebug("OLIAPI parsed");